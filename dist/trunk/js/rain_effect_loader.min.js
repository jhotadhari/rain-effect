(()=>{"use strict";var t={n:e=>{var i=e&&e.__esModule?()=>e.default:()=>e;return t.d(i,{a:i}),i},d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function n(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=n.key,o=void 0,o=function(t,e){if("object"!==r(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(a),"symbol"===r(o)?o:String(o)),n)}var a,o}t.r(e),t.d(e,{activeTexture:()=>d,createProgram:()=>h,createShader:()=>u,createTexture:()=>c,createUniform:()=>p,getContext:()=>l,setRectangle:()=>f,updateTexture:()=>m});const o=jQuery;var s=t.n(o);function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=null;return["webgl","experimental-webgl"].some((function(n){try{i=t.getContext(n,e)}catch(t){}return null!==i})),null===i&&document.body.classList.add("no-webgl"),i}function h(t,e,i){var n=u(t,e,t.VERTEX_SHADER),r=u(t,i,t.FRAGMENT_SHADER),a=t.createProgram();if(t.attachShader(a,n),t.attachShader(a,r),t.linkProgram(a),!t.getProgramParameter(a,t.LINK_STATUS))return g("Error in program linking: "+t.getProgramInfoLog(a)),t.deleteProgram(a),null;var o=t.getAttribLocation(a,"a_position"),s=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,s),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),t.STATIC_DRAW);var l=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,l),t.enableVertexAttribArray(o),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),a}function u(t,e,i){var n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(g("Error compiling shader '"+n+"':"+t.getShaderInfoLog(n)),t.deleteShader(n),null)}function c(t,e,i){var n=t.createTexture();return d(t,i),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),m(t,e),n}function p(t,e,i,n){for(var r=t.getUniformLocation(e,"u_"+n),a=arguments.length,o=new Array(a>4?a-4:0),s=4;s<a;s++)o[s-4]=arguments[s];t["uniform"+i].apply(t,[r].concat(o))}function d(t,e){t.activeTexture(t["TEXTURE"+e])}function m(t,e){e&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)}function f(t,e,i,n,r){var a=e,o=e+n,s=i,l=i+r;t.bufferData(t.ARRAY_BUFFER,new Float32Array([a,s,o,s,a,l,a,l,o,s,o,l]),t.STATIC_DRAW)}function g(t){console.error(t)}function x(t,e,i,n){this.init(t,e,i,n)}x.prototype={canvas:null,gl:null,program:null,width:0,height:0,init:function(t,e,i,n){this.canvas=t,this.width=t.width,this.height=t.height,this.gl=l(t,e),this.program=this.createProgram(i,n),this.useProgram(this.program)},createProgram:function(t,e){return h(this.gl,t,e)},useProgram:function(t){this.program=t,this.gl.useProgram(t)},createTexture:function(t,e){return c(this.gl,t,e)},createUniform:function(t,i){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];p.apply(e,[this.gl,this.program,t,i].concat(r))},activeTexture:function(t){d(this.gl,t)},updateTexture:function(t){m(this.gl,t)},draw:function(){f(this.gl,-1,-1,2,2),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}};const v=x;function w(t,e){var i=document.createElement("canvas");return i.width=t,i.height=e,i}var b={renderShadow:!1,minRefraction:256,maxRefraction:512,brightness:1,alphaMultiply:20,alphaSubtract:5,parallaxBg:5,parallaxFg:20};function y(t,e,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.canvas=t,this.inView=e,this.canvasLiquid=i,this.imageShine=a,this.imageFg=n,this.imageBg=r,this.options=Object.assign({},b,o),this.init()}y.prototype={canvas:null,inView:!1,gl:null,canvasLiquid:null,width:0,height:0,imageShine:"",imageFg:"",imageBg:"",textures:null,programWater:null,programBlurX:null,programBlurY:null,parallaxX:0,parallaxY:0,renderShadow:!1,options:null,init:function(){this.width=this.canvas.width,this.height=this.canvas.height,this.gl=new v(this.canvas,{alpha:!1},"precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 a_position;\n\nvoid main() {\n   gl_Position = vec4(a_position,0.0,1.0);\n}\n",'precision mediump float;\n#define GLSLIFY 1\n\n// textures\nuniform sampler2D u_waterMap;\nuniform sampler2D u_textureShine;\nuniform sampler2D u_textureFg;\nuniform sampler2D u_textureBg;\n\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform vec2 u_parallax;\nuniform float u_parallaxFg;\nuniform float u_parallaxBg;\nuniform float u_textureRatio;\nuniform bool u_renderShine;\nuniform bool u_renderShadow;\nuniform float u_minRefraction;\nuniform float u_refractionDelta;\nuniform float u_brightness;\nuniform float u_alphaMultiply;\nuniform float u_alphaSubtract;\n\n// alpha-blends two colors\nvec4 blend(vec4 bg,vec4 fg){\n  vec3 bgm=bg.rgb*bg.a;\n  vec3 fgm=fg.rgb*fg.a;\n  float ia=1.0-fg.a;\n  float a=(fg.a + bg.a * ia);\n  vec3 rgb;\n  if(a!=0.0){\n    rgb=(fgm + bgm * ia) / a;\n  }else{\n    rgb=vec3(0.0,0.0,0.0);\n  }\n  return vec4(rgb,a);\n}\n\nvec2 pixel(){\n  return vec2(1.0,1.0)/u_resolution;\n}\n\nvec2 parallax(float v){\n  return u_parallax*pixel()*v;\n}\n\nvec2 texCoord(){\n  return vec2(gl_FragCoord.x, u_resolution.y-gl_FragCoord.y)/u_resolution;\n}\n\n// scales the bg up and proportionally to fill the container\nvec2 scaledTexCoord(){\n  float ratio=u_resolution.x/u_resolution.y;\n  vec2 scale=vec2(1.0,1.0);\n  vec2 offset=vec2(0.0,0.0);\n  float ratioDelta=ratio-u_textureRatio;\n  if(ratioDelta>=0.0){\n    scale.y=(1.0+ratioDelta);\n    offset.y=ratioDelta/2.0;\n  }else{\n    scale.x=(1.0-ratioDelta);\n    offset.x=-ratioDelta/2.0;\n  }\n  return (texCoord()+offset)/scale;\n}\n\n// get color from fg\nvec4 fgColor(float x, float y){\n  float p2=u_parallaxFg*2.0;\n  vec2 scale=vec2(\n    (u_resolution.x+p2)/u_resolution.x,\n    (u_resolution.y+p2)/u_resolution.y\n  );\n\n  vec2 scaledTexCoord=texCoord()/scale;\n  vec2 offset=vec2(\n    (1.0-(1.0/scale.x))/2.0,\n    (1.0-(1.0/scale.y))/2.0\n  );\n\n  return texture2D(u_waterMap,\n    (scaledTexCoord+offset)+(pixel()*vec2(x,y))+parallax(u_parallaxFg)\n  );\n}\n\nvoid main() {\n  vec4 bg=texture2D(u_textureBg,scaledTexCoord()+parallax(u_parallaxBg));\n\n  vec4 cur = fgColor(0.0,0.0);\n\n  float d=cur.b; // "thickness"\n  float x=cur.g;\n  float y=cur.r;\n\n  float a=clamp(cur.a*u_alphaMultiply-u_alphaSubtract, 0.0,1.0);\n\n  vec2 refraction = (vec2(x,y)-0.5)*2.0;\n  vec2 refractionParallax=parallax(u_parallaxBg-u_parallaxFg);\n  vec2 refractionPos = scaledTexCoord()\n    + (pixel()*refraction*(u_minRefraction+(d*u_refractionDelta)))\n    + refractionParallax;\n\n  vec4 tex=texture2D(u_textureFg,refractionPos);\n\n  if(u_renderShine){\n    float maxShine=490.0;\n    float minShine=maxShine*0.18;\n    vec2 shinePos=vec2(0.5,0.5) + ((1.0/512.0)*refraction)* -(minShine+((maxShine-minShine)*d));\n    vec4 shine=texture2D(u_textureShine,shinePos);\n    tex=blend(tex,shine);\n  }\n\n  vec4 fg=vec4(tex.rgb*u_brightness,a);\n\n  if(u_renderShadow){\n    float borderAlpha = fgColor(0.,0.-(d*6.0)).a;\n    borderAlpha=borderAlpha*u_alphaMultiply-(u_alphaSubtract+0.5);\n    borderAlpha=clamp(borderAlpha,0.,1.);\n    borderAlpha*=0.2;\n    vec4 border=vec4(0.,0.,0.,borderAlpha);\n    fg=blend(border,fg);\n  }\n\n  gl_FragColor = blend(bg,fg);\n}\n');var t=this.gl;this.programWater=t.program,t.createUniform("2f","resolution",this.width,this.height),t.createUniform("1f","textureRatio",this.imageBg.width/this.imageBg.height),t.createUniform("1i","renderShine",null!==this.imageShine),t.createUniform("1i","renderShadow",this.options.renderShadow),t.createUniform("1f","minRefraction",this.options.minRefraction),t.createUniform("1f","refractionDelta",this.options.maxRefraction-this.options.minRefraction),t.createUniform("1f","brightness",this.options.brightness),t.createUniform("1f","alphaMultiply",this.options.alphaMultiply),t.createUniform("1f","alphaSubtract",this.options.alphaSubtract),t.createUniform("1f","parallaxBg",this.options.parallaxBg),t.createUniform("1f","parallaxFg",this.options.parallaxFg),t.createTexture(null,0),this.textures=[{name:"textureShine",img:null===this.imageShine?w(2,2):this.imageShine},{name:"textureFg",img:this.imageFg},{name:"textureBg",img:this.imageBg}],this.textures.forEach((function(e,i){t.createTexture(e.img,i+1),t.createUniform("1i",e.name,i+1)})),this.draw()},draw:function(){this.gl.useProgram(this.programWater),this.gl.createUniform("2f","parallax",this.parallaxX,this.parallaxY),this.updateTexture(),this.gl.draw(),requestAnimationFrame(this.draw.bind(this))},updateTextures:function(){var t=this;this.textures.forEach((function(e,i){t.gl.activeTexture(i+1),t.gl.updateTexture(e.img)}))},updateTexture:function(){this.inView&&(this.gl.activeTexture(0),this.gl.updateTexture(this.canvasLiquid))},resize:function(){},get overlayTexture(){},set overlayTexture(t){}};const R=y;function S(t,e){for(var i=0;i<t;i++)e.call(this,i)}function _(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===t?(t=0,e=1):null!==t&&null===e&&(e=t,t=0);var n=e-t;return null===i&&(i=function(t){return t}),t+i(Math.random())*n}function T(t){return _()<=t}var D=64,C={x:0,y:0,r:0,spreadX:0,spreadY:0,momentum:0,momentumX:0,lastSpawn:0,nextSpawn:0,parent:null,isNew:!0,killed:!1,shrink:0},A={minR:10,maxR:40,maxDrops:900,rainChance:.3,rainLimit:3,dropletsRate:50,dropletsSize:[2,4],dropletsCleaningRadiusMultiplier:.43,raining:!0,globalTimeScale:1,trailRate:1,autoShrink:!0,spawnArea:[-.1,.95],trailScaleRange:[.2,.5],collisionRadius:.65,collisionRadiusIncrease:.01,dropFallMultiplier:1,collisionBoostMultiplier:.05,collisionBoost:1};function E(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.inView=t,this.width=e,this.height=i,this.scale=n,this.dropAlpha=r,this.dropColor=a,this.options=Object.assign({},A,o),this.init()}function P(t){return Math.pow(t,3)}E.prototype={dropColor:null,dropAlpha:null,canvas:null,ctx:null,width:0,height:0,inView:null,scale:0,dropletsPixelDensity:1,droplets:null,dropletsCtx:null,dropletsCounter:0,drops:null,dropsGfx:null,clearDropletsGfx:null,textureCleaningIterations:0,lastRender:null,options:null,init:function(){this.canvas=w(this.width,this.height),this.ctx=this.canvas.getContext("2d"),this.droplets=w(this.width*this.dropletsPixelDensity,this.height*this.dropletsPixelDensity),this.dropletsCtx=this.droplets.getContext("2d"),this.drops=[],this.dropsGfx=[],this.renderDropsGfx(),this.update()},get deltaR(){return this.options.maxR-this.options.minR},get area(){return this.width*this.height/this.scale},get areaMultiplier(){return Math.sqrt(this.area/786432)},drawDroplet:function(t,e,i){this.drawDrop(this.dropletsCtx,Object.assign(Object.create(C),{x:t*this.dropletsPixelDensity,y:e*this.dropletsPixelDensity,r:i*this.dropletsPixelDensity}))},renderDropsGfx:function(){var t=this,e=w(D,D),i=e.getContext("2d");this.dropsGfx=Array.apply(null,Array(255)).map((function(n,r){var a=w(D,D),o=a.getContext("2d");return i.clearRect(0,0,D,D),i.globalCompositeOperation="source-over",i.drawImage(t.dropColor,0,0,D,D),i.globalCompositeOperation="screen",i.fillStyle="rgba(0,0,"+r+",1)",i.fillRect(0,0,D,D),o.globalCompositeOperation="source-over",o.drawImage(t.dropAlpha,0,0,D,D),o.globalCompositeOperation="source-in",o.drawImage(e,0,0,D,D),a})),this.clearDropletsGfx=w(128,128);var n=this.clearDropletsGfx.getContext("2d");n.fillStyle="#000",n.beginPath(),n.arc(64,64,64,0,2*Math.PI),n.fill()},drawDrop:function(t,e){if(this.dropsGfx.length>0){var i=e.x,n=e.y,r=e.r,a=e.spreadX,o=e.spreadY,s=Math.max(0,Math.min(1,(r-this.options.minR)/this.deltaR*.9));s*=1/(.5*(e.spreadX+e.spreadY)+1),t.globalAlpha=1,t.globalCompositeOperation="source-over",s=Math.floor(s*(this.dropsGfx.length-1)),t.drawImage(this.dropsGfx[s],(i-1*r*(a+1))*this.scale,(n-1.5*r*(o+1))*this.scale,2*r*1*(a+1)*this.scale,2*r*1.5*(o+1)*this.scale)}},clearDroplets:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,n=this.dropletsCtx;n.globalCompositeOperation="destination-out",n.drawImage(this.clearDropletsGfx,(t-i)*this.dropletsPixelDensity*this.scale,(e-i)*this.dropletsPixelDensity*this.scale,2*i*this.dropletsPixelDensity*this.scale,2*i*this.dropletsPixelDensity*this.scale*1.5)},clearCanvas:function(){this.ctx.clearRect(0,0,this.width,this.height)},createDrop:function(t){return this.drops.length>=this.options.maxDrops*this.areaMultiplier?null:Object.assign(Object.create(C),t)},addDrop:function(t){return!(this.drops.length>=this.options.maxDrops*this.areaMultiplier||null===t||(this.drops.push(t),0))},updateRain:function(t){var e=[];if(this.options.raining)for(var i=this.options.rainLimit*t*this.areaMultiplier,n=0;T(this.options.rainChance*t*this.areaMultiplier)&&n<i;){n++;var r=_(this.options.minR,this.options.maxR,P),a=this.createDrop({x:_(this.width/this.scale),y:_(this.height/this.scale*this.options.spawnArea[0],this.height/this.scale*this.options.spawnArea[1]),r,momentum:1+.1*(r-this.options.minR)+_(2),spreadX:1.5,spreadY:1.5});null!==a&&e.push(a)}return e},clearDrops:function(){this.drops.forEach((function(t){setTimeout((function(){t.shrink=.1+_(.5)}),_(1200))})),this.clearTexture()},clearTexture:function(){this.textureCleaningIterations=50},updateDroplets:function(t){var e=this;this.textureCleaningIterations>0&&(this.textureCleaningIterations-=1*t,this.dropletsCtx.globalCompositeOperation="destination-out",this.dropletsCtx.fillStyle="rgba(0,0,0,"+.05*t+")",this.dropletsCtx.fillRect(0,0,this.width*this.dropletsPixelDensity,this.height*this.dropletsPixelDensity)),this.options.raining&&(this.dropletsCounter+=this.options.dropletsRate*t*this.areaMultiplier,S(this.dropletsCounter,(function(t){e.dropletsCounter--,e.drawDroplet(_(e.width/e.scale),_(e.height/e.scale),_.apply(void 0,n(e.options.dropletsSize).concat([function(t){return t*t}])))}))),this.ctx.drawImage(this.droplets,0,0,this.width,this.height)},updateDrops:function(t){var e=this,i=[];this.updateDroplets(t);var r=this.updateRain(t);i=i.concat(r),this.drops.sort((function(t,i){var n=t.y*(e.width/e.scale)+t.x,r=i.y*(e.width/e.scale)+i.x;return n>r?1:n==r?0:-1})),this.drops.forEach((function(e,r){var a=this;if(!e.killed){if(T((e.r-this.options.minR*this.options.dropFallMultiplier)*(.1/this.deltaR)*t)&&(e.momentum+=_(e.r/this.options.maxR*4)),this.options.autoShrink&&e.r<=this.options.minR&&T(.05*t)&&(e.shrink+=.01),e.r-=e.shrink*t,e.r<=0&&(e.killed=!0),this.options.raining&&(e.lastSpawn+=e.momentum*t*this.options.trailRate,e.lastSpawn>e.nextSpawn)){var o=this.createDrop({x:e.x+.1*_(-e.r,e.r),y:e.y-.01*e.r,r:e.r*_.apply(void 0,n(this.options.trailScaleRange)),spreadY:.1*e.momentum,parent:e});null!==o&&(i.push(o),e.r*=Math.pow(.97,t),e.lastSpawn=0,e.nextSpawn=_(this.options.minR,this.options.maxR)-2*e.momentum*this.options.trailRate+(this.options.maxR-e.r))}e.spreadX*=Math.pow(.4,t),e.spreadY*=Math.pow(.7,t);var s=e.momentum>0;s&&!e.killed&&(e.y+=e.momentum*this.options.globalTimeScale,e.x+=e.momentumX*this.options.globalTimeScale,e.y>this.height/this.scale+e.r&&(e.killed=!0));var l=(s||e.isNew)&&!e.killed;e.isNew=!1,l&&this.drops.slice(r+1,r+70).forEach((function(i){if(e!=i&&e.r>i.r&&e.parent!=i&&i.parent!=e&&!i.killed){var n=i.x-e.x,r=i.y-e.y;if(Math.sqrt(n*n+r*r)<(e.r+i.r)*(a.options.collisionRadius+e.momentum*a.options.collisionRadiusIncrease*t)){var o=Math.PI,s=e.r,l=i.r,h=o*(s*s),u=o*(l*l),c=Math.sqrt((h+.8*u)/o);c>a.maxR&&(c=a.maxR),e.r=c,e.momentumX+=.1*n,e.spreadX=0,e.spreadY=0,i.killed=!0,e.momentum=Math.max(i.momentum,Math.min(40,e.momentum+c*a.options.collisionBoostMultiplier+a.options.collisionBoost))}}})),e.momentum-=.1*Math.max(1,.5*this.options.minR-e.momentum)*t,e.momentum<0&&(e.momentum=0),e.momentumX*=Math.pow(.7,t),e.killed||(i.push(e),s&&this.options.dropletsRate>0&&this.clearDroplets(e.x,e.y,e.r*this.options.dropletsCleaningRadiusMultiplier),this.drawDrop(this.ctx,e))}}),this),this.drops=i},update:function(){if(this.inView){this.clearCanvas();var t=Date.now();null===this.lastRender&&(this.lastRender=t);var e=(t-this.lastRender)/(1/60*1e3);e>1.1&&(e=1.1),e*=this.options.globalTimeScale,this.lastRender=t,this.updateDrops(e)}requestAnimationFrame(this.update.bind(this))}};const M=E;var F=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.enabled=!0,this.el=e,this.el=e,this.$el=s()(e),this.updateGeometrie(),this.updateViewport(),this.setCanvas(),this.updateCss(),this.loadTextures()}var e,i;return e=t,(i=[{key:"updateGeometrie",value:function(){this.dimensions={height:this.$el.outerHeight(),width:this.$el.outerWidth()},this.dimensions.ratio=this.dimensions.height/this.dimensions.width,this.position=this.$el.offset(),this.position.bottom=this.position.top+this.dimensions.height,this.position.right=this.position.left+this.dimensions.width}},{key:"updateViewport",value:function(){this.viewport={},this.viewport.top=s()(window).scrollTop(),this.viewport.bottom=this.viewport.top+s()(window).height()}},{key:"inView",value:function(t){return t=t||50,this.position.bottom>this.viewport.top-t&&this.position.top<this.viewport.bottom+t}},{key:"setCanvas",value:function(){this.canvas=w(this.dimensions.width,this.dimensions.height),this.$canvas=s()(this.canvas),this.$el.after(this.canvas),this.fallback=this.el}},{key:"updateCss",value:function(){var t=document.defaultView.getComputedStyle(this.el,null);this.$canvas.css({float:t.float,margin:t.margin,maxWidth:t.maxWidth,maxHeight:t.maxHeight,height:t.height,width:t.width,border:t.border,verticalAlign:t.verticalAlign}),"none"!==t.display&&this.$canvas.css({display:t.display}),this.$el.css("display","none")}},{key:"loadTextures",value:function(){var t=this,e=this.el,i=e.srcset,r=e.src,a=rain_effect_loader_data,o=a.ajaxurl,l=a.images,h=l.dropShine,u=l.dropAlpha,c=l.dropColor,p=!1;if(i){var d,m=i.split(",").map((function(t,e){return t.trim().split(" ").map((function(t,e){return 0===e?t:t.indexOf("w")?t.replace("w",""):null}))})).map((function(t,e){return{width:parseInt(t[1]),src:t[0]}})),f=n(m).filter((function(t){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)>=t.width}));d=f.length<1?n(m).reduce((function(t,e){return t.width<e.width?t:e})):n(f).reduce((function(t,e){return t.width>e.width?t:e})),p=!(!d||!d.src)&&d.src}i&&p||(p=r),s().post(o,{action:"rain_thumbnail",srcFull:r}).done((function(e){var i;(e=s().parseJSON(e)).hasOwnProperty("srcThumbnail")&&(i=[{name:"foreground",src:e.srcThumbnail},{name:"background",src:p},{name:"dropShine",src:h},{name:"dropAlpha",src:u},{name:"dropColor",src:c}],new Promise((function(t,e){(function(t,e){return Promise.all(t.map((function(t,i){return function(t,e,i){return new Promise((function(n,r){"string"==typeof t&&(t={name:"image"+e,src:t});var a=new Image;t.img=a,a.addEventListener("load",(function(r){"function"==typeof i&&i.call(null,a,e),n(t)})),a.src=t.src}))}(t,i,e)})))})(i,undefined).then((function(e){var i={};e.forEach((function(t){i[t.name]={img:t.img,src:t.src}})),t(i)}))}))).then((function(e){t.textures=e,t.startRain()}))}))}},{key:"startRain",value:function(){var t=this;this.raindrops=new M(this.inView,this.canvas.width,this.canvas.height,window.devicePixelRatio,this.textures.dropAlpha.img,this.textures.dropColor.img,{minR:20,maxR:60,dropletsRate:25,globalTimeScale:.5,trailRate:1.1,spawnArea:[-.3,.3],trailScaleRange:[.2,.35],dropFallMultiplier:.2,collisionBoost:.35,collisionBoostMultiplier:.025}),S(80,(function(e){t.raindrops.addDrop(t.raindrops.createDrop({x:_(t.canvas.width),y:_(t.canvas.height),r:_(10,20)}))})),this.renderer=new R(this.canvas,this.inView,this.raindrops.canvas,this.textures.foreground.img,this.textures.background.img,this.textures.dropShine.img,{brightness:1,renderShadow:!0,minRefraction:150,maxRefraction:512,alphaMultiply:7,alphaSubtract:3}),this.setupEvents()}},{key:"setupEvents",value:function(){var t=this,e=!1;document.addEventListener("scroll",(function(){clearTimeout(e),e=setTimeout((function(){t.updateGeometrie(),t.updateViewport(),t.renderer.inView=t.inView,t.raindrops.inView=t.inView}),100)}));var i=!1;window.addEventListener("resize",(function(){clearTimeout(i),i=setTimeout((function(){t.updateCss(),t.updateGeometrie(),t.updateViewport()}),100)})),document.addEventListener("mousemove",(function(e){t.setupParallax(e)}))}},{key:"setupParallax",value:function(t){if(this.inView){var e=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),i=t.pageX-this.position.left,n=t.pageY-e;this.renderer.parallaxX=i/this.canvas.width*2-1,this.renderer.parallaxY=n/this.canvas.height*2-2}}}])&&a(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();s()((function(){s()("img.rain-effect:not(.no-rain), .wp-block-image.rain-effect:not(.no-rain) img").each((function(t){new F(this)}))}))})();