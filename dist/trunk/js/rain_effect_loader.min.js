!function(){return function e(t,r,i){function n(o,s){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var h=r[o]={exports:{}};t[o][0].call(h.exports,function(e){return n(t[o][1][e]||e)},h,h.exports,e,t,r,i)}return r[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}}()({1:[function(e,t,r){"use strict";t.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}},{}],2:[function(e,t,r){"use strict";var i=e("./arrayLikeToArray");t.exports=function(e){if(Array.isArray(e))return i(e)}},{"./arrayLikeToArray":1}],3:[function(e,t,r){"use strict";t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],4:[function(e,t,r){"use strict";function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}t.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),e}},{}],5:[function(e,t,r){"use strict";t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],6:[function(e,t,r){"use strict";var i=e("../helpers/typeof");function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}t.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=n();if(t&&t.has(e))return t.get(e);var r={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var s=a?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(r,o,s):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}},{"../helpers/typeof":10}],7:[function(e,t,r){"use strict";t.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},{}],8:[function(e,t,r){"use strict";t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},{}],9:[function(e,t,r){"use strict";var i=e("./arrayWithoutHoles"),n=e("./iterableToArray"),a=e("./unsupportedIterableToArray"),o=e("./nonIterableSpread");t.exports=function(e){return i(e)||n(e)||a(e)||o()}},{"./arrayWithoutHoles":2,"./iterableToArray":7,"./nonIterableSpread":8,"./unsupportedIterableToArray":11}],10:[function(e,t,r){"use strict";function i(e){"@babel/helpers - typeof";return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=i=function(e){return typeof e}:t.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}t.exports=i},{}],11:[function(e,t,r){"use strict";var i=e("./arrayLikeToArray");t.exports=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}},{"./arrayLikeToArray":1}],12:[function(e,t,r){"use strict";t.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),r=[],i=0;i<e.length-1;i++)r.push(e[i],t[i]||"");return r.push(e[i]),r.join("")}},{}],13:[function(e,t,r){(function(t){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("@babel/runtime/helpers/toConsumableArray")),n=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),o=r("undefined"!=typeof window?window.jQuery:void 0!==t?t.jQuery:null),s=r(e("./rain_effect_loader/rain-renderer")),l=r(e("./rain_effect_loader/raindrops")),u=r(e("./rain_effect_loader/image-loader")),h=r(e("./rain_effect_loader/create-canvas")),c=r(e("./rain_effect_loader/times")),p=e("./rain_effect_loader/random"),d=function(){function e(t){(0,n.default)(this,e),this.enabled=!0,this.el=t,this.el=t,this.$el=(0,o.default)(t),this.updateGeometrie(),this.updateViewport(),this.setCanvas(),this.updateCss(),this.loadTextures()}return(0,a.default)(e,[{key:"updateGeometrie",value:function(){this.dimensions={height:this.$el.outerHeight(),width:this.$el.outerWidth()},this.dimensions.ratio=this.dimensions.height/this.dimensions.width,this.position=this.$el.offset(),this.position.bottom=this.position.top+this.dimensions.height,this.position.right=this.position.left+this.dimensions.width}},{key:"updateViewport",value:function(){this.viewport={},this.viewport.top=(0,o.default)(window).scrollTop(),this.viewport.bottom=this.viewport.top+(0,o.default)(window).height()}},{key:"inView",value:function(e){return e=e||50,this.position.bottom>this.viewport.top-e&&this.position.top<this.viewport.bottom+e}},{key:"setCanvas",value:function(){this.canvas=(0,h.default)(this.dimensions.width,this.dimensions.height),this.$canvas=(0,o.default)(this.canvas),this.$el.after(this.canvas),this.fallback=this.el}},{key:"updateCss",value:function(){var e=document.defaultView.getComputedStyle(this.el,null);this.$canvas.css({float:e.float,margin:e.margin,maxWidth:e.maxWidth,maxHeight:e.maxHeight,height:e.height,width:e.width,border:e.border,verticalAlign:e.verticalAlign}),"none"!==e.display&&this.$canvas.css({display:e.display}),this.$el.css("display","none")}},{key:"loadTextures",value:function(){var e=this,t=this.el,r=t.srcset,n=t.src,a=rain_effect_loader_data,s=a.ajaxurl,l=a.images,h=l.dropShine,c=l.dropAlpha,p=l.dropColor,d=!1;if(r){var f,m=r.split(",").map(function(e,t){return e.trim().split(" ").map(function(e,t){return 0===t?e:e.indexOf("w")?e.replace("w",""):null})}).map(function(e,t){return{width:parseInt(e[1]),src:e[0]}}),g=(0,i.default)(m).filter(function(e){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)>=e.width});f=g.length<1?(0,i.default)(m).reduce(function(e,t){return e.width<t.width?e:t}):(0,i.default)(g).reduce(function(e,t){return e.width>t.width?e:t}),d=!(!f||!f.src)&&f.src}r&&d||(d=n),o.default.post(s,{action:"rain_thumbnail",srcFull:n}).done(function(t){(t=o.default.parseJSON(t)).hasOwnProperty("srcThumbnail")&&(0,u.default)([{name:"foreground",src:t.srcThumbnail},{name:"background",src:d},{name:"dropShine",src:h},{name:"dropAlpha",src:c},{name:"dropColor",src:p}]).then(function(t){e.textures=t,e.startRain()})})}},{key:"startRain",value:function(){var e=this;this.raindrops=new l.default(this.inView,this.canvas.width,this.canvas.height,window.devicePixelRatio,this.textures.dropAlpha.img,this.textures.dropColor.img,{minR:20,maxR:60,dropletsRate:25,globalTimeScale:.5,trailRate:1.1,spawnArea:[-.3,.3],trailScaleRange:[.2,.35],dropFallMultiplier:.2,collisionBoost:.35,collisionBoostMultiplier:.025}),(0,c.default)(80,function(t){e.raindrops.addDrop(e.raindrops.createDrop({x:(0,p.random)(e.canvas.width),y:(0,p.random)(e.canvas.height),r:(0,p.random)(10,20)}))}),this.renderer=new s.default(this.canvas,this.inView,this.raindrops.canvas,this.textures.foreground.img,this.textures.background.img,this.textures.dropShine.img,{brightness:1,renderShadow:!0,minRefraction:150,maxRefraction:512,alphaMultiply:7,alphaSubtract:3}),this.setupEvents()}},{key:"setupEvents",value:function(){var e=this,t=!1;document.addEventListener("scroll",function(){clearTimeout(t),t=setTimeout(function(){e.updateGeometrie(),e.updateViewport(),e.renderer.inView=e.inView,e.raindrops.inView=e.inView},100)});var r=!1;window.addEventListener("resize",function(){clearTimeout(r),r=setTimeout(function(){e.updateCss(),e.updateGeometrie(),e.updateViewport()},100)}),document.addEventListener("mousemove",function(t){e.setupParallax(t)})}},{key:"setupParallax",value:function(e){if(this.inView){var t=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),r=e.pageX-this.position.left,i=e.pageY-t;this.renderer.parallaxX=r/this.canvas.width*2-1,this.renderer.parallaxY=i/this.canvas.height*2-2}}}]),e}();(0,o.default)(document).ready(function(){(0,o.default)(window).load(function(){(0,o.default)("img.rain-effect:not(.no-rain), .wp-block-image.rain-effect:not(.no-rain) img").each(function(e){new d(this)})})})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./rain_effect_loader/create-canvas":14,"./rain_effect_loader/image-loader":16,"./rain_effect_loader/rain-renderer":17,"./rain_effect_loader/raindrops":18,"./rain_effect_loader/random":19,"./rain_effect_loader/times":20,"@babel/runtime/helpers/classCallCheck":3,"@babel/runtime/helpers/createClass":4,"@babel/runtime/helpers/interopRequireDefault":5,"@babel/runtime/helpers/toConsumableArray":9}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}},{}],15:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("./webgl"));function a(e,t,r,i){this.init(e,t,r,i)}a.prototype={canvas:null,gl:null,program:null,width:0,height:0,init:function(e,t,r,i){this.canvas=e,this.width=e.width,this.height=e.height,this.gl=n.getContext(e,t),this.program=this.createProgram(r,i),this.useProgram(this.program)},createProgram:function(e,t){return n.createProgram(this.gl,e,t)},useProgram:function(e){this.program=e,this.gl.useProgram(e)},createTexture:function(e,t){return n.createTexture(this.gl,e,t)},createUniform:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];n.createUniform.apply(n,[this.gl,this.program,e,t].concat(i))},activeTexture:function(e){n.activeTexture(this.gl,e)},updateTexture:function(e){n.updateTexture(this.gl,e)},draw:function(){n.setRectangle(this.gl,-1,-1,2,2),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}};var o=a;r.default=o},{"./webgl":21,"@babel/runtime/helpers/interopRequireWildcard":6}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){return new Promise(function(r,i){(function(e,t){return Promise.all(e.map(function(e,r){return function(e,t,r){return new Promise(function(i,n){"string"==typeof e&&(e={name:"image"+t,src:e});var a=new Image;e.img=a,a.addEventListener("load",function(n){"function"==typeof r&&r.call(null,a,t),i(e)}),a.src=e.src})}(e,r,t)}))})(e,t).then(function(e){var t={};e.forEach(function(e){t[e.name]={img:e.img,src:e.src}}),r(t)})})}},{}],17:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault"),n=e("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;n(e("./webgl"));var a=i(e("./gl-obj")),o=(i(e("./image-loader")),i(e("./create-canvas"))),s=e("glslify"),l=s(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 a_position;\n\nvoid main() {\n   gl_Position = vec4(a_position,0.0,1.0);\n}\n"]),u=s(['precision mediump float;\n#define GLSLIFY 1\n\n// textures\nuniform sampler2D u_waterMap;\nuniform sampler2D u_textureShine;\nuniform sampler2D u_textureFg;\nuniform sampler2D u_textureBg;\n\n// the texCoords passed in from the vertex shader.\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform vec2 u_parallax;\nuniform float u_parallaxFg;\nuniform float u_parallaxBg;\nuniform float u_textureRatio;\nuniform bool u_renderShine;\nuniform bool u_renderShadow;\nuniform float u_minRefraction;\nuniform float u_refractionDelta;\nuniform float u_brightness;\nuniform float u_alphaMultiply;\nuniform float u_alphaSubtract;\n\n// alpha-blends two colors\nvec4 blend(vec4 bg,vec4 fg){\n  vec3 bgm=bg.rgb*bg.a;\n  vec3 fgm=fg.rgb*fg.a;\n  float ia=1.0-fg.a;\n  float a=(fg.a + bg.a * ia);\n  vec3 rgb;\n  if(a!=0.0){\n    rgb=(fgm + bgm * ia) / a;\n  }else{\n    rgb=vec3(0.0,0.0,0.0);\n  }\n  return vec4(rgb,a);\n}\n\nvec2 pixel(){\n  return vec2(1.0,1.0)/u_resolution;\n}\n\nvec2 parallax(float v){\n  return u_parallax*pixel()*v;\n}\n\nvec2 texCoord(){\n  return vec2(gl_FragCoord.x, u_resolution.y-gl_FragCoord.y)/u_resolution;\n}\n\n// scales the bg up and proportionally to fill the container\nvec2 scaledTexCoord(){\n  float ratio=u_resolution.x/u_resolution.y;\n  vec2 scale=vec2(1.0,1.0);\n  vec2 offset=vec2(0.0,0.0);\n  float ratioDelta=ratio-u_textureRatio;\n  if(ratioDelta>=0.0){\n    scale.y=(1.0+ratioDelta);\n    offset.y=ratioDelta/2.0;\n  }else{\n    scale.x=(1.0-ratioDelta);\n    offset.x=-ratioDelta/2.0;\n  }\n  return (texCoord()+offset)/scale;\n}\n\n// get color from fg\nvec4 fgColor(float x, float y){\n  float p2=u_parallaxFg*2.0;\n  vec2 scale=vec2(\n    (u_resolution.x+p2)/u_resolution.x,\n    (u_resolution.y+p2)/u_resolution.y\n  );\n\n  vec2 scaledTexCoord=texCoord()/scale;\n  vec2 offset=vec2(\n    (1.0-(1.0/scale.x))/2.0,\n    (1.0-(1.0/scale.y))/2.0\n  );\n\n  return texture2D(u_waterMap,\n    (scaledTexCoord+offset)+(pixel()*vec2(x,y))+parallax(u_parallaxFg)\n  );\n}\n\nvoid main() {\n  vec4 bg=texture2D(u_textureBg,scaledTexCoord()+parallax(u_parallaxBg));\n\n  vec4 cur = fgColor(0.0,0.0);\n\n  float d=cur.b; // "thickness"\n  float x=cur.g;\n  float y=cur.r;\n\n  float a=clamp(cur.a*u_alphaMultiply-u_alphaSubtract, 0.0,1.0);\n\n  vec2 refraction = (vec2(x,y)-0.5)*2.0;\n  vec2 refractionParallax=parallax(u_parallaxBg-u_parallaxFg);\n  vec2 refractionPos = scaledTexCoord()\n    + (pixel()*refraction*(u_minRefraction+(d*u_refractionDelta)))\n    + refractionParallax;\n\n  vec4 tex=texture2D(u_textureFg,refractionPos);\n\n  if(u_renderShine){\n    float maxShine=490.0;\n    float minShine=maxShine*0.18;\n    vec2 shinePos=vec2(0.5,0.5) + ((1.0/512.0)*refraction)* -(minShine+((maxShine-minShine)*d));\n    vec4 shine=texture2D(u_textureShine,shinePos);\n    tex=blend(tex,shine);\n  }\n\n  vec4 fg=vec4(tex.rgb*u_brightness,a);\n\n  if(u_renderShadow){\n    float borderAlpha = fgColor(0.,0.-(d*6.0)).a;\n    borderAlpha=borderAlpha*u_alphaMultiply-(u_alphaSubtract+0.5);\n    borderAlpha=clamp(borderAlpha,0.,1.);\n    borderAlpha*=0.2;\n    vec4 border=vec4(0.,0.,0.,borderAlpha);\n    fg=blend(border,fg);\n  }\n\n  gl_FragColor = blend(bg,fg);\n}\n']),h={renderShadow:!1,minRefraction:256,maxRefraction:512,brightness:1,alphaMultiply:20,alphaSubtract:5,parallaxBg:5,parallaxFg:20};function c(e,t,r,i,n){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.canvas=e,this.inView=t,this.canvasLiquid=r,this.imageShine=a,this.imageFg=i,this.imageBg=n,this.options=Object.assign({},h,o),this.init()}c.prototype={canvas:null,inView:!1,gl:null,canvasLiquid:null,width:0,height:0,imageShine:"",imageFg:"",imageBg:"",textures:null,programWater:null,programBlurX:null,programBlurY:null,parallaxX:0,parallaxY:0,renderShadow:!1,options:null,init:function(){this.width=this.canvas.width,this.height=this.canvas.height,this.gl=new a.default(this.canvas,{alpha:!1},l,u);var e=this.gl;this.programWater=e.program,e.createUniform("2f","resolution",this.width,this.height),e.createUniform("1f","textureRatio",this.imageBg.width/this.imageBg.height),e.createUniform("1i","renderShine",null!==this.imageShine),e.createUniform("1i","renderShadow",this.options.renderShadow),e.createUniform("1f","minRefraction",this.options.minRefraction),e.createUniform("1f","refractionDelta",this.options.maxRefraction-this.options.minRefraction),e.createUniform("1f","brightness",this.options.brightness),e.createUniform("1f","alphaMultiply",this.options.alphaMultiply),e.createUniform("1f","alphaSubtract",this.options.alphaSubtract),e.createUniform("1f","parallaxBg",this.options.parallaxBg),e.createUniform("1f","parallaxFg",this.options.parallaxFg),e.createTexture(null,0),this.textures=[{name:"textureShine",img:null===this.imageShine?(0,o.default)(2,2):this.imageShine},{name:"textureFg",img:this.imageFg},{name:"textureBg",img:this.imageBg}],this.textures.forEach(function(t,r){e.createTexture(t.img,r+1),e.createUniform("1i",t.name,r+1)}),this.draw()},draw:function(){this.gl.useProgram(this.programWater),this.gl.createUniform("2f","parallax",this.parallaxX,this.parallaxY),this.updateTexture(),this.gl.draw(),requestAnimationFrame(this.draw.bind(this))},updateTextures:function(){var e=this;this.textures.forEach(function(t,r){e.gl.activeTexture(r+1),e.gl.updateTexture(t.img)})},updateTexture:function(){this.inView&&(this.gl.activeTexture(0),this.gl.updateTexture(this.canvasLiquid))},resize:function(){},get overlayTexture(){},set overlayTexture(e){}};var p=c;r.default=p},{"./create-canvas":14,"./gl-obj":15,"./image-loader":16,"./webgl":21,"@babel/runtime/helpers/interopRequireDefault":5,"@babel/runtime/helpers/interopRequireWildcard":6,glslify:12}],18:[function(e,t,r){"use strict";var i=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=i(e("@babel/runtime/helpers/toConsumableArray")),a=(i(e("./image-loader")),i(e("./times.js"))),o=i(e("./create-canvas.js")),s=e("./random"),l={x:0,y:0,r:0,spreadX:0,spreadY:0,momentum:0,momentumX:0,lastSpawn:0,nextSpawn:0,parent:null,isNew:!0,killed:!1,shrink:0},u={minR:10,maxR:40,maxDrops:900,rainChance:.3,rainLimit:3,dropletsRate:50,dropletsSize:[2,4],dropletsCleaningRadiusMultiplier:.43,raining:!0,globalTimeScale:1,trailRate:1,autoShrink:!0,spawnArea:[-.1,.95],trailScaleRange:[.2,.5],collisionRadius:.65,collisionRadiusIncrease:.01,dropFallMultiplier:1,collisionBoostMultiplier:.05,collisionBoost:1};function h(e,t,r,i,n,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};this.inView=e,this.width=t,this.height=r,this.scale=i,this.dropAlpha=n,this.dropColor=a,this.options=Object.assign({},u,o),this.init()}function c(e){return Math.pow(e,3)}h.prototype={dropColor:null,dropAlpha:null,canvas:null,ctx:null,width:0,height:0,inView:null,scale:0,dropletsPixelDensity:1,droplets:null,dropletsCtx:null,dropletsCounter:0,drops:null,dropsGfx:null,clearDropletsGfx:null,textureCleaningIterations:0,lastRender:null,options:null,init:function(){this.canvas=(0,o.default)(this.width,this.height),this.ctx=this.canvas.getContext("2d"),this.droplets=(0,o.default)(this.width*this.dropletsPixelDensity,this.height*this.dropletsPixelDensity),this.dropletsCtx=this.droplets.getContext("2d"),this.drops=[],this.dropsGfx=[],this.renderDropsGfx(),this.update()},get deltaR(){return this.options.maxR-this.options.minR},get area(){return this.width*this.height/this.scale},get areaMultiplier(){return Math.sqrt(this.area/786432)},drawDroplet:function(e,t,r){this.drawDrop(this.dropletsCtx,Object.assign(Object.create(l),{x:e*this.dropletsPixelDensity,y:t*this.dropletsPixelDensity,r:r*this.dropletsPixelDensity}))},renderDropsGfx:function(){var e=this,t=(0,o.default)(64,64),r=t.getContext("2d");this.dropsGfx=Array.apply(null,Array(255)).map(function(i,n){var a=(0,o.default)(64,64),s=a.getContext("2d");return r.clearRect(0,0,64,64),r.globalCompositeOperation="source-over",r.drawImage(e.dropColor,0,0,64,64),r.globalCompositeOperation="screen",r.fillStyle="rgba(0,0,"+n+",1)",r.fillRect(0,0,64,64),s.globalCompositeOperation="source-over",s.drawImage(e.dropAlpha,0,0,64,64),s.globalCompositeOperation="source-in",s.drawImage(t,0,0,64,64),a}),this.clearDropletsGfx=(0,o.default)(128,128);var i=this.clearDropletsGfx.getContext("2d");i.fillStyle="#000",i.beginPath(),i.arc(64,64,64,0,2*Math.PI),i.fill()},drawDrop:function(e,t){if(this.dropsGfx.length>0){var r=t.x,i=t.y,n=t.r,a=t.spreadX,o=t.spreadY,s=Math.max(0,Math.min(1,(n-this.options.minR)/this.deltaR*.9));s*=1/(.5*(t.spreadX+t.spreadY)+1),e.globalAlpha=1,e.globalCompositeOperation="source-over",s=Math.floor(s*(this.dropsGfx.length-1)),e.drawImage(this.dropsGfx[s],(r-1*n*(a+1))*this.scale,(i-1.5*n*(o+1))*this.scale,2*n*1*(a+1)*this.scale,2*n*1.5*(o+1)*this.scale)}},clearDroplets:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30,i=this.dropletsCtx;i.globalCompositeOperation="destination-out",i.drawImage(this.clearDropletsGfx,(e-r)*this.dropletsPixelDensity*this.scale,(t-r)*this.dropletsPixelDensity*this.scale,2*r*this.dropletsPixelDensity*this.scale,2*r*this.dropletsPixelDensity*this.scale*1.5)},clearCanvas:function(){this.ctx.clearRect(0,0,this.width,this.height)},createDrop:function(e){return this.drops.length>=this.options.maxDrops*this.areaMultiplier?null:Object.assign(Object.create(l),e)},addDrop:function(e){return!(this.drops.length>=this.options.maxDrops*this.areaMultiplier||null===e)&&(this.drops.push(e),!0)},updateRain:function(e){var t=[];if(this.options.raining)for(var r=this.options.rainLimit*e*this.areaMultiplier,i=0;(0,s.chance)(this.options.rainChance*e*this.areaMultiplier)&&i<r;){i++;var n=(0,s.random)(this.options.minR,this.options.maxR,c),a=this.createDrop({x:(0,s.random)(this.width/this.scale),y:(0,s.random)(this.height/this.scale*this.options.spawnArea[0],this.height/this.scale*this.options.spawnArea[1]),r:n,momentum:1+.1*(n-this.options.minR)+(0,s.random)(2),spreadX:1.5,spreadY:1.5});null!==a&&t.push(a)}return t},clearDrops:function(){this.drops.forEach(function(e){setTimeout(function(){e.shrink=.1+(0,s.random)(.5)},(0,s.random)(1200))}),this.clearTexture()},clearTexture:function(){this.textureCleaningIterations=50},updateDroplets:function(e){var t=this;this.textureCleaningIterations>0&&(this.textureCleaningIterations-=1*e,this.dropletsCtx.globalCompositeOperation="destination-out",this.dropletsCtx.fillStyle="rgba(0,0,0,"+.05*e+")",this.dropletsCtx.fillRect(0,0,this.width*this.dropletsPixelDensity,this.height*this.dropletsPixelDensity)),this.options.raining&&(this.dropletsCounter+=this.options.dropletsRate*e*this.areaMultiplier,(0,a.default)(this.dropletsCounter,function(e){t.dropletsCounter--,t.drawDroplet((0,s.random)(t.width/t.scale),(0,s.random)(t.height/t.scale),s.random.apply(void 0,(0,n.default)(t.options.dropletsSize).concat([function(e){return e*e}])))})),this.ctx.drawImage(this.droplets,0,0,this.width,this.height)},updateDrops:function(e){var t=this,r=[];this.updateDroplets(e);var i=this.updateRain(e);r=r.concat(i),this.drops.sort(function(e,r){var i=e.y*(t.width/t.scale)+e.x,n=r.y*(t.width/t.scale)+r.x;return i>n?1:i==n?0:-1}),this.drops.forEach(function(t,i){var a=this;if(!t.killed){if((0,s.chance)((t.r-this.options.minR*this.options.dropFallMultiplier)*(.1/this.deltaR)*e)&&(t.momentum+=(0,s.random)(t.r/this.options.maxR*4)),this.options.autoShrink&&t.r<=this.options.minR&&(0,s.chance)(.05*e)&&(t.shrink+=.01),t.r-=t.shrink*e,t.r<=0&&(t.killed=!0),this.options.raining&&(t.lastSpawn+=t.momentum*e*this.options.trailRate,t.lastSpawn>t.nextSpawn)){var o=this.createDrop({x:t.x+.1*(0,s.random)(-t.r,t.r),y:t.y-.01*t.r,r:t.r*s.random.apply(void 0,(0,n.default)(this.options.trailScaleRange)),spreadY:.1*t.momentum,parent:t});null!==o&&(r.push(o),t.r*=Math.pow(.97,e),t.lastSpawn=0,t.nextSpawn=(0,s.random)(this.options.minR,this.options.maxR)-2*t.momentum*this.options.trailRate+(this.options.maxR-t.r))}t.spreadX*=Math.pow(.4,e),t.spreadY*=Math.pow(.7,e);var l=t.momentum>0;l&&!t.killed&&(t.y+=t.momentum*this.options.globalTimeScale,t.x+=t.momentumX*this.options.globalTimeScale,t.y>this.height/this.scale+t.r&&(t.killed=!0));var u=(l||t.isNew)&&!t.killed;t.isNew=!1,u&&this.drops.slice(i+1,i+70).forEach(function(r){if(t!=r&&t.r>r.r&&t.parent!=r&&r.parent!=t&&!r.killed){var i=r.x-t.x,n=r.y-t.y;if(Math.sqrt(i*i+n*n)<(t.r+r.r)*(a.options.collisionRadius+t.momentum*a.options.collisionRadiusIncrease*e)){var o=Math.PI,s=t.r,l=r.r,u=o*(s*s),h=o*(l*l),c=Math.sqrt((u+.8*h)/o);c>a.maxR&&(c=a.maxR),t.r=c,t.momentumX+=.1*i,t.spreadX=0,t.spreadY=0,r.killed=!0,t.momentum=Math.max(r.momentum,Math.min(40,t.momentum+c*a.options.collisionBoostMultiplier+a.options.collisionBoost))}}}),t.momentum-=.1*Math.max(1,.5*this.options.minR-t.momentum)*e,t.momentum<0&&(t.momentum=0),t.momentumX*=Math.pow(.7,e),t.killed||(r.push(t),l&&this.options.dropletsRate>0&&this.clearDroplets(t.x,t.y,t.r*this.options.dropletsCleaningRadiusMultiplier),this.drawDrop(this.ctx,t))}},this),this.drops=r},update:function(){if(this.inView){this.clearCanvas();var e=Date.now();null===this.lastRender&&(this.lastRender=e);var t=(e-this.lastRender)/(1/60*1e3);t>1.1&&(t=1.1),t*=this.options.globalTimeScale,this.lastRender=e,this.updateDrops(t)}requestAnimationFrame(this.update.bind(this))}};var p=h;r.default=p},{"./create-canvas.js":14,"./image-loader":16,"./random":19,"./times.js":20,"@babel/runtime/helpers/interopRequireDefault":5,"@babel/runtime/helpers/toConsumableArray":9}],19:[function(e,t,r){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null===e?(e=0,t=1):null!==e&&null===t&&(t=e,e=0);var i=t-e;return null===r&&(r=function(e){return e}),e+r(Math.random())*i}Object.defineProperty(r,"__esModule",{value:!0}),r.random=i,r.chance=function(e){return i()<=e}},{}],20:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){for(var r=0;r<e;r++)t.call(this,r)}},{}],21:[function(e,t,r){"use strict";function i(e,t,r){var i=e.createShader(r);return e.shaderSource(i,t),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS)?i:(o("Error compiling shader '"+i+"':"+e.getShaderInfoLog(i)),e.deleteShader(i),null)}function n(e,t){e.activeTexture(e["TEXTURE"+t])}function a(e,t){t&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)}function o(e){console.error(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.getContext=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null;["webgl","experimental-webgl"].some(function(i){try{r=e.getContext(i,t)}catch(e){}return null!==r}),null===r&&document.body.classList.add("no-webgl");return r},r.createProgram=function(e,t,r){var n=i(e,t,e.VERTEX_SHADER),a=i(e,r,e.FRAGMENT_SHADER),s=e.createProgram();if(e.attachShader(s,n),e.attachShader(s,a),e.linkProgram(s),!e.getProgramParameter(s,e.LINK_STATUS)){var l=e.getProgramInfoLog(s);return o("Error in program linking: "+l),e.deleteProgram(s),null}var u=e.getAttribLocation(s,"a_position"),h=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW);var c=e.createBuffer();return e.bindBuffer(e.ARRAY_BUFFER,c),e.enableVertexAttribArray(u),e.vertexAttribPointer(u,2,e.FLOAT,!1,0,0),s},r.createShader=i,r.createTexture=function(e,t,r){var i=e.createTexture();return n(e,r),e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),a(e,t),i},r.createUniform=function(e,t,r,i){for(var n=e.getUniformLocation(t,"u_"+i),a=arguments.length,o=new Array(a>4?a-4:0),s=4;s<a;s++)o[s-4]=arguments[s];e["uniform"+r].apply(e,[n].concat(o))},r.activeTexture=n,r.updateTexture=a,r.setRectangle=function(e,t,r,i,n){var a=t,o=t+i,s=r,l=r+n;e.bufferData(e.ARRAY_BUFFER,new Float32Array([a,s,o,s,a,l,a,l,o,s,o,l]),e.STATIC_DRAW)}},{}]},{},[13]);